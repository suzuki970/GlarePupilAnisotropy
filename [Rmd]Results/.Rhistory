eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
countFigNum = countFigNum+1
#### Early component ANOVA ####
data_anova = data_auc[data_auc$comp == 'Early',]
data_anova$comp = NULL
anovakun(data_anova,"sAB",long=T, peta=T, gg=T)
data_anova$Locs = factor(data_anova$Locs,levels = unique(data_anova$Locs))
data_anova$Pattern = factor(data_anova$Pattern,levels = unique(data_anova$Pattern))
data_anova$sub = factor(data_anova$sub,levels = unique(data_anova$sub))
data_anova_Early_BF = anovaBF(data_y ~ Locs*Pattern + sub, data=data_anova, whichRandom = "sub")
fig3a_anovatable = forDrawingSigANOVA
fig3a_ttest = forDrawingPost[["A"]][["bontab"]]
fig3a_inter = forDrawingPost[["A:B"]][["simtab"]]
data_anova_Early = list(list(
anovaTab = forDrawingSigANOVA,
post = forDrawingPost[["A"]][["bontab"]],
bf = round(exp(data_anova_Early_BF@bayesFactor[["bf"]]),3),
fig3a_ttest = fig3a_ttest,
fig3a_inter = fig3a_inter
))
names(data_anova_Early) <- c('data_anova_Early')
anovaTabAll = c(anovaTabAll,data_anova_Early)
#### Late component ANOVA ####
data_anova = data_auc[data_auc$comp == 'Late',]
data_anova$comp = NULL
anovakun(data_anova,"sAB",long=T, peta=T, gg=T)
data_anova$Locs = factor(data_anova$Locs,levels = unique(data_anova$Locs))
data_anova$Pattern = factor(data_anova$Pattern,levels = unique(data_anova$Pattern))
data_anova$sub = factor(data_anova$sub,levels = unique(data_anova$sub))
data_anova_Late_BF = anovaBF(data_y ~ Locs*Pattern + sub, data=data_anova, whichRandom = "sub")
fig3b_anovatable = forDrawingSigANOVA
fig3b_ttest = forDrawingPost[["A"]][["bontab"]]
fig3b_inter = forDrawingPost[["A:B"]][["simtab"]]
data_anova_Late = list(list(
anovaTab = forDrawingSigANOVA,
post = forDrawingPost[["A"]][["bontab"]],
bf = round(exp(data_anova_Late_BF@bayesFactor[["bf"]]),3),
fig3b_ttest = fig3b_ttest,
fig3b_inter = fig3b_inter
))
names(data_anova_Late) <- c('data_anova_Late')
anovaTabAll = c(anovaTabAll,data_anova_Late)
p1
p2
# make data set -----------------------------------------------------------------
if(!file.exists("./data/dataset.rda")){
source("makeDataSet.R")
}else{
load('./data/dataset.rda')
}
countFigNum = 1
# Figure 2A -----------------------------------------------------------------
data_auc$Locs = factor(data_auc$Locs, go1)
data_center = data_auc[data_auc$Locs == 'Center',]
data_center$sub = subName[data_center$sub]
config = list(
alpha = 0.4,
stride = 0.1,
label_x = "",
label_y = "Pupil Changes [z-score]",
title = "",
grCol = rep(c("white","black"),5),
gr_outline =  rep(c("black","black"),5)
)
# Figure 3A (center early) --------------------------------------------------
tmp = data_center[data_center$comp == 'Early',]
x = tmp[tmp$Pattern == 'Glare',]$data_y
y = tmp[tmp$Pattern == 'Control',]$data_y
cohen_d = cohen.d(x,y,paired=TRUE, within=TRUE)
bf = ttestBF(x = x, y = y, paired=TRUE)
center_early_table = list(list(
anovaTab = t.test(x,y,var.equal=T,paired=T),
cohend = round(abs(cohen_d[["estimate"]]),3),
bf = round(exp(bf@bayesFactor[["bf"]]),3)
))
names(center_early_table) <- c('center_early_table')
anovaTabAll = c(anovaTabAll,center_early_table)
p <- dispLineGraph(data_center[data_center$comp == 'Early',],config,c("Locs","Pattern"))+
# facet_grid(. ~ Locs)+
ggtitle('Early')
config$ylim = round(seq(-0.5,0,0.1),2)
config$ylim_stride = 0.05
config$xlim = round(seq(1,2,1),2)
config$xlim_stride = 0.5
p = setEmptyStyle(p,config)
p <- p + theme(
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x = element_blank()
)
eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
countFigNum = countFigNum+1
# Figure 3A (center late)  --------------------------------------------------
tmp = data_center[data_center$comp == 'Late',]
x = tmp[tmp$Pattern == 'Glare',]$data_y
y = tmp[tmp$Pattern == 'Control',]$data_y
cohen_d = cohen.d(x,y,paired=TRUE, within=TRUE)
bf = ttestBF(x = x, y = y, paired=TRUE)
center_late_table = list(list(
anovaTab = t.test(x,y,var.equal=T,paired=T),
cohend = round(abs(cohen_d[["estimate"]]),3),
bf = round(exp(bf@bayesFactor[["bf"]]),3)
))
names(center_late_table) <- c('center_late_table')
anovaTabAll = c(anovaTabAll,center_late_table)
config$label_y = "AUC [z-score]"
p <- dispLineGraph(data_center[data_center$comp == 'Late',],config,c("Locs","Pattern"))+
facet_grid(. ~ Locs)+
ggtitle('Late')
config$ylim = round(seq(0,1.5,0.5),2)
config$ylim_stride = 0.05
config$xlim = round(seq(1,2,1),2)
config$xlim_stride = 0.5
p = setEmptyStyle(p,config)
p <- p + theme(
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x = element_blank()
)
eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
countFigNum = countFigNum+1
#### Figure 3BC ####
data_auc = data_auc[data_auc$Locs != 'Center',]
config$label_y = "Pupil Changes [z-score]"
p <- dispLineGraph(data_auc[data_auc$comp == 'Early',],config,c("Locs","Pattern"))+
facet_grid(. ~ Locs)+
ggtitle('Early')
config$ylim = round(seq(-0.2,0.2,0.1),2)
config$ylim_stride = 0.05
config$xlim = round(seq(1,2,1),2)
config$xlim_stride = 0.5
p = setEmptyStyle(p,config)
p <- p + theme(
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x = element_blank()
)
eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
countFigNum = countFigNum+1
#### Figure 3B ####
config$label_y = "AUC [z-score]"
p <- dispLineGraph(data_auc[data_auc$comp == 'Late',],config,c("Locs","Pattern"))+
facet_grid(. ~ Locs)+
ggtitle('Late(AUC)')
config$ylim = round(seq(0,1.2,0.2),2)
config$ylim_stride = 0.15
config$xlim = round(seq(1,2,1),2)
config$xlim_stride = 0.5
p = setEmptyStyle(p,config)
p <- p + theme(
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x = element_blank()
)
eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
countFigNum = countFigNum+1
#### Early component ANOVA ####
data_anova = data_auc[data_auc$comp == 'Early',]
data_anova$comp = NULL
anovakun(data_anova,"sAB",long=T, peta=T, gg=T)
data_anova$Locs = factor(data_anova$Locs,levels = unique(data_anova$Locs))
data_anova$Pattern = factor(data_anova$Pattern,levels = unique(data_anova$Pattern))
data_anova$sub = factor(data_anova$sub,levels = unique(data_anova$sub))
data_anova_Early_BF = anovaBF(data_y ~ Locs*Pattern + sub, data=data_anova, whichRandom = "sub")
fig3a_anovatable = forDrawingSigANOVA
fig3a_ttest = forDrawingPost[["A"]][["bontab"]]
fig3a_inter = forDrawingPost[["A:B"]][["simtab"]]
data_anova_Early = list(list(
anovaTab = forDrawingSigANOVA,
post = forDrawingPost[["A"]][["bontab"]],
bf = round(exp(data_anova_Early_BF@bayesFactor[["bf"]]),3),
fig3a_ttest = fig3a_ttest,
fig3a_inter = fig3a_inter
))
names(data_anova_Early) <- c('data_anova_Early')
anovaTabAll = c(anovaTabAll,data_anova_Early)
#### Late component ANOVA ####
data_anova = data_auc[data_auc$comp == 'Late',]
data_anova$comp = NULL
anovakun(data_anova,"sAB",long=T, peta=T, gg=T)
data_anova$Locs = factor(data_anova$Locs,levels = unique(data_anova$Locs))
data_anova$Pattern = factor(data_anova$Pattern,levels = unique(data_anova$Pattern))
data_anova$sub = factor(data_anova$sub,levels = unique(data_anova$sub))
data_anova_Late_BF = anovaBF(data_y ~ Locs*Pattern + sub, data=data_anova, whichRandom = "sub")
fig3b_anovatable = forDrawingSigANOVA
fig3b_ttest = forDrawingPost[["A"]][["bontab"]]
fig3b_inter = forDrawingPost[["A:B"]][["simtab"]]
data_anova_Late = list(list(
anovaTab = forDrawingSigANOVA,
post = forDrawingPost[["A"]][["bontab"]],
bf = round(exp(data_anova_Late_BF@bayesFactor[["bf"]]),3),
fig3b_ttest = fig3b_ttest,
fig3b_inter = fig3b_inter
))
names(data_anova_Late) <- c('data_anova_Late')
anovaTabAll = c(anovaTabAll,data_anova_Late)
p2
p1
p3
p4
# make data set -----------------------------------------------------------------
if(!file.exists("./data/dataset.rda")){
source("makeDataSet.R")
}else{
load('./data/dataset.rda')
}
countFigNum = 1
# Figure 2A -----------------------------------------------------------------
data_auc$Locs = factor(data_auc$Locs, go1)
data_center = data_auc[data_auc$Locs == 'Center',]
data_center$sub = subName[data_center$sub]
config = list(
alpha = 0.4,
stride = 0.1,
label_x = "",
label_y = "Pupil Changes [z-score]",
title = "",
grCol = rep(c("white","black"),5),
gr_outline =  rep(c("black","black"),5)
)
# Figure 3A (center early) --------------------------------------------------
tmp = data_center[data_center$comp == 'Early',]
x = tmp[tmp$Pattern == 'Glare',]$data_y
y = tmp[tmp$Pattern == 'Control',]$data_y
cohen_d = cohen.d(x,y,paired=TRUE, within=TRUE)
bf = ttestBF(x = x, y = y, paired=TRUE)
center_early_table = list(list(
anovaTab = t.test(x,y,var.equal=T,paired=T),
cohend = round(abs(cohen_d[["estimate"]]),3),
bf = round(exp(bf@bayesFactor[["bf"]]),3)
))
names(center_early_table) <- c('center_early_table')
anovaTabAll = c(anovaTabAll,center_early_table)
p <- dispLineGraph(data_center[data_center$comp == 'Early',],config,c("Locs","Pattern"))+
# facet_grid(. ~ Locs)+
ggtitle('Early')
config$ylim = round(seq(-0.5,0,0.1),2)
config$ylim_stride = 0.05
config$xlim = round(seq(1,2,1),2)
config$xlim_stride = 0.5
p = setEmptyStyle(p,config)
# p <- p + theme(
#   axis.title.x=element_blank(),
#   axis.text.x=element_blank(),
#   axis.ticks.x = element_blank()
# )
eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
countFigNum = countFigNum+1
# Figure 3A (center late)  --------------------------------------------------
tmp = data_center[data_center$comp == 'Late',]
x = tmp[tmp$Pattern == 'Glare',]$data_y
y = tmp[tmp$Pattern == 'Control',]$data_y
cohen_d = cohen.d(x,y,paired=TRUE, within=TRUE)
bf = ttestBF(x = x, y = y, paired=TRUE)
center_late_table = list(list(
anovaTab = t.test(x,y,var.equal=T,paired=T),
cohend = round(abs(cohen_d[["estimate"]]),3),
bf = round(exp(bf@bayesFactor[["bf"]]),3)
))
names(center_late_table) <- c('center_late_table')
anovaTabAll = c(anovaTabAll,center_late_table)
config$label_y = "AUC [z-score]"
p <- dispLineGraph(data_center[data_center$comp == 'Late',],config,c("Locs","Pattern"))+
facet_grid(. ~ Locs)+
ggtitle('Late')
config$ylim = round(seq(0,1.5,0.5),2)
config$ylim_stride = 0.05
config$xlim = round(seq(1,2,1),2)
config$xlim_stride = 0.5
p = setEmptyStyle(p,config)
# p <- p + theme(
#   axis.title.x=element_blank(),
#   axis.text.x=element_blank(),
#   axis.ticks.x = element_blank()
# )
eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
countFigNum = countFigNum+1
#### Figure 3BC ####
data_auc = data_auc[data_auc$Locs != 'Center',]
config$label_y = "Pupil Changes [z-score]"
p <- dispLineGraph(data_auc[data_auc$comp == 'Early',],config,c("Locs","Pattern"))+
facet_grid(. ~ Locs)+
ggtitle('Early')
config$ylim = round(seq(-0.2,0.2,0.1),2)
config$ylim_stride = 0.05
config$xlim = round(seq(1,2,1),2)
config$xlim_stride = 0.5
p = setEmptyStyle(p,config)
# p <- p + theme(
#   axis.title.x=element_blank(),
#   axis.text.x=element_blank(),
#   axis.ticks.x = element_blank()
# )
eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
countFigNum = countFigNum+1
#### Figure 3B ####
config$label_y = "AUC [z-score]"
p <- dispLineGraph(data_auc[data_auc$comp == 'Late',],config,c("Locs","Pattern"))+
facet_grid(. ~ Locs)+
ggtitle('Late(AUC)')
config$ylim = round(seq(0,1.2,0.2),2)
config$ylim_stride = 0.15
config$xlim = round(seq(1,2,1),2)
config$xlim_stride = 0.5
p = setEmptyStyle(p,config)
# p <- p + theme(
#   axis.title.x=element_blank(),
#   axis.text.x=element_blank(),
#   axis.ticks.x = element_blank()
# )
eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
countFigNum = countFigNum+1
#### Early component ANOVA ####
data_anova = data_auc[data_auc$comp == 'Early',]
data_anova$comp = NULL
anovakun(data_anova,"sAB",long=T, peta=T, gg=T)
data_anova$Locs = factor(data_anova$Locs,levels = unique(data_anova$Locs))
data_anova$Pattern = factor(data_anova$Pattern,levels = unique(data_anova$Pattern))
data_anova$sub = factor(data_anova$sub,levels = unique(data_anova$sub))
data_anova_Early_BF = anovaBF(data_y ~ Locs*Pattern + sub, data=data_anova, whichRandom = "sub")
fig3a_anovatable = forDrawingSigANOVA
fig3a_ttest = forDrawingPost[["A"]][["bontab"]]
fig3a_inter = forDrawingPost[["A:B"]][["simtab"]]
data_anova_Early = list(list(
anovaTab = forDrawingSigANOVA,
post = forDrawingPost[["A"]][["bontab"]],
bf = round(exp(data_anova_Early_BF@bayesFactor[["bf"]]),3),
fig3a_ttest = fig3a_ttest,
fig3a_inter = fig3a_inter
))
names(data_anova_Early) <- c('data_anova_Early')
anovaTabAll = c(anovaTabAll,data_anova_Early)
#### Late component ANOVA ####
data_anova = data_auc[data_auc$comp == 'Late',]
data_anova$comp = NULL
anovakun(data_anova,"sAB",long=T, peta=T, gg=T)
data_anova$Locs = factor(data_anova$Locs,levels = unique(data_anova$Locs))
data_anova$Pattern = factor(data_anova$Pattern,levels = unique(data_anova$Pattern))
data_anova$sub = factor(data_anova$sub,levels = unique(data_anova$sub))
data_anova_Late_BF = anovaBF(data_y ~ Locs*Pattern + sub, data=data_anova, whichRandom = "sub")
fig3b_anovatable = forDrawingSigANOVA
fig3b_ttest = forDrawingPost[["A"]][["bontab"]]
fig3b_inter = forDrawingPost[["A:B"]][["simtab"]]
data_anova_Late = list(list(
anovaTab = forDrawingSigANOVA,
post = forDrawingPost[["A"]][["bontab"]],
bf = round(exp(data_anova_Late_BF@bayesFactor[["bf"]]),3),
fig3b_ttest = fig3b_ttest,
fig3b_inter = fig3b_inter
))
names(data_anova_Late) <- c('data_anova_Late')
anovaTabAll = c(anovaTabAll,data_anova_Late)
p3
p3
p4
# make data set -----------------------------------------------------------------
if(!file.exists("./data/dataset.rda")){
source("makeDataSet.R")
}else{
load('./data/dataset.rda')
}
countFigNum = 1
# Figure 2A -----------------------------------------------------------------
data_auc$Locs = factor(data_auc$Locs, go1)
data_center = data_auc[data_auc$Locs == 'Center',]
data_center$sub = subName[data_center$sub]
config = list(
alpha = 0.4,
stride = 0.1,
label_x = "",
label_y = "Pupil Changes [z-score]",
title = "",
grCol = rep(c("white","black"),5),
gr_outline =  rep(c("black","black"),5)
)
# Figure 3A (center early) --------------------------------------------------
tmp = data_center[data_center$comp == 'Early',]
x = tmp[tmp$Pattern == 'Glare',]$data_y
y = tmp[tmp$Pattern == 'Control',]$data_y
cohen_d = cohen.d(x,y,paired=TRUE, within=TRUE)
bf = ttestBF(x = x, y = y, paired=TRUE)
center_early_table = list(list(
anovaTab = t.test(x,y,var.equal=T,paired=T),
cohend = round(abs(cohen_d[["estimate"]]),3),
bf = round(exp(bf@bayesFactor[["bf"]]),3)
))
names(center_early_table) <- c('center_early_table')
anovaTabAll = c(anovaTabAll,center_early_table)
p <- dispLineGraph(data_center[data_center$comp == 'Early',],config,c("Locs","Pattern"))+
# facet_grid(. ~ Locs)+
ggtitle('Early')
config$ylim = round(seq(-0.5,0,0.1),2)
config$ylim_stride = 0.05
config$xlim = round(seq(1,2,1),2)
config$xlim_stride = 0.5
p = setEmptyStyle(p,config)
# p <- p + theme(
#   axis.title.x=element_blank(),
#   axis.text.x=element_blank(),
#   axis.ticks.x = element_blank()
# )
eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
countFigNum = countFigNum+1
# Figure 3A (center late)  --------------------------------------------------
tmp = data_center[data_center$comp == 'Late',]
x = tmp[tmp$Pattern == 'Glare',]$data_y
y = tmp[tmp$Pattern == 'Control',]$data_y
cohen_d = cohen.d(x,y,paired=TRUE, within=TRUE)
bf = ttestBF(x = x, y = y, paired=TRUE)
center_late_table = list(list(
anovaTab = t.test(x,y,var.equal=T,paired=T),
cohend = round(abs(cohen_d[["estimate"]]),3),
bf = round(exp(bf@bayesFactor[["bf"]]),3)
))
names(center_late_table) <- c('center_late_table')
anovaTabAll = c(anovaTabAll,center_late_table)
config$label_y = "AUC [z-score]"
p <- dispLineGraph(data_center[data_center$comp == 'Late',],config,c("Locs","Pattern"))+
facet_grid(. ~ Locs)+
ggtitle('Late')
config$ylim = round(seq(0,1.5,0.5),2)
config$ylim_stride = 0.05
config$xlim = round(seq(1,2,1),2)
config$xlim_stride = 0.5
p = setEmptyStyle(p,config)
# p <- p + theme(
#   axis.title.x=element_blank(),
#   axis.text.x=element_blank(),
#   axis.ticks.x = element_blank()
# )
eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
countFigNum = countFigNum+1
#### Figure 3BC ####
data_auc = data_auc[data_auc$Locs != 'Center',]
config$label_y = "Pupil Changes [z-score]"
p <- dispLineGraph(data_auc[data_auc$comp == 'Early',],config,c("Locs","Pattern"))+
facet_grid(. ~ Locs)+
ggtitle('Early')
config$ylim = round(seq(-0.2,0.2,0.1),2)
config$ylim_stride = 0.05
config$xlim = round(seq(1,2,1),2)
config$xlim_stride = 0.5
p = setEmptyStyle(p,config)
# p <- p + theme(
#   axis.title.x=element_blank(),
#   axis.text.x=element_blank(),
#   axis.ticks.x = element_blank()
# )
eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
countFigNum = countFigNum+1
#### Figure 3B ####
config$label_y = "AUC [z-score]"
p <- dispLineGraph(data_auc[data_auc$comp == 'Late',],config,c("Locs","Pattern"))+
facet_grid(. ~ Locs)+
ggtitle('Late(AUC)')
config$ylim = round(seq(0,1.4,0.2),2)
config$ylim_stride = 0.15
config$xlim = round(seq(1,2,1),2)
config$xlim_stride = 0.5
p = setEmptyStyle(p,config)
# p <- p + theme(
#   axis.title.x=element_blank(),
#   axis.text.x=element_blank(),
#   axis.ticks.x = element_blank()
# )
eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
countFigNum = countFigNum+1
#### Early component ANOVA ####
data_anova = data_auc[data_auc$comp == 'Early',]
data_anova$comp = NULL
anovakun(data_anova,"sAB",long=T, peta=T, gg=T)
data_anova$Locs = factor(data_anova$Locs,levels = unique(data_anova$Locs))
data_anova$Pattern = factor(data_anova$Pattern,levels = unique(data_anova$Pattern))
data_anova$sub = factor(data_anova$sub,levels = unique(data_anova$sub))
data_anova_Early_BF = anovaBF(data_y ~ Locs*Pattern + sub, data=data_anova, whichRandom = "sub")
fig3a_anovatable = forDrawingSigANOVA
fig3a_ttest = forDrawingPost[["A"]][["bontab"]]
fig3a_inter = forDrawingPost[["A:B"]][["simtab"]]
data_anova_Early = list(list(
anovaTab = forDrawingSigANOVA,
post = forDrawingPost[["A"]][["bontab"]],
bf = round(exp(data_anova_Early_BF@bayesFactor[["bf"]]),3),
fig3a_ttest = fig3a_ttest,
fig3a_inter = fig3a_inter
))
names(data_anova_Early) <- c('data_anova_Early')
anovaTabAll = c(anovaTabAll,data_anova_Early)
#### Late component ANOVA ####
data_anova = data_auc[data_auc$comp == 'Late',]
data_anova$comp = NULL
anovakun(data_anova,"sAB",long=T, peta=T, gg=T)
data_anova$Locs = factor(data_anova$Locs,levels = unique(data_anova$Locs))
data_anova$Pattern = factor(data_anova$Pattern,levels = unique(data_anova$Pattern))
data_anova$sub = factor(data_anova$sub,levels = unique(data_anova$sub))
data_anova_Late_BF = anovaBF(data_y ~ Locs*Pattern + sub, data=data_anova, whichRandom = "sub")
fig3b_anovatable = forDrawingSigANOVA
fig3b_ttest = forDrawingPost[["A"]][["bontab"]]
fig3b_inter = forDrawingPost[["A:B"]][["simtab"]]
data_anova_Late = list(list(
anovaTab = forDrawingSigANOVA,
post = forDrawingPost[["A"]][["bontab"]],
bf = round(exp(data_anova_Late_BF@bayesFactor[["bf"]]),3),
fig3b_ttest = fig3b_ttest,
fig3b_inter = fig3b_inter
))
names(data_anova_Late) <- c('data_anova_Late')
anovaTabAll = c(anovaTabAll,data_anova_Late)
p4
p3
library(zoo)
anovaTabAll[["data_anova_Late"]][["fig3b_ttest"]]
anovaTabAll[["data_anova_Late"]][["fig3b_inter"]]
