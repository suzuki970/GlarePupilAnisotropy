---
title: "Result notes"
author: "Yuta Suzuki"
date: "4/23/2021"
output: 
  word_document
  # slidy_presentation:
  #   css: style.css
params:
  year: 2021
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r child="readFunc.Rmd"}
```

## Article information

Pupil response asymmetries of the periphery visual field in the glare illusion

Novera Istiqomah, Yuta Suzuki, Yuya Kinzuka, Minami Tetsuto, Shigeki Nakauchi

*Corresponding author: Yuta Suzuki


```{r, message=FALSE, warning=FALSE, echo=FALSE, include=FALSE}
# source("makeDataSet.R")

countFigNum = 1

go1 <- c("Center","Upper","Lower","Left","Right")
######## file loading ########
load("./data/dataset20211124.rda")
data_e1$Locs = factor(data_e1$Locs, go1)
numOfSub = length(unique(data_e1$sub))
sTime = -0.2
eTime = max(data_e1$data_x)

anovaTabAll = list()

######## Figure 2A ########
data_e1_ave = aggregate( data_y ~ data_x*Locs*Pattern, data = data_e1, FUN = "mean")

config = list(lim_x = c(sTime, eTime),
              lim_y = c(-0.5, 0.7),
              alpha = 0.4,
              stride = 0.1,
              label_x = "Time [sec]",
              label_y = "Pupil Changes [z-scored]",
              title = "",
              linetype = TRUE,
              grCol = rep(c("#101010","#101010"),10),
              gr_outline =  rep(c("#101010","#101010"),10)
)

p <- disp(data_e1,config,1,c("Pattern","Locs"))
p <- p +
  facet_grid(. ~ Locs)

config$ylim = round(seq(-0.5,0.75,0.25),2)
config$ylim_stride = 0.05
config$xlim = round(seq(0,4,1),2)
config$xlim_stride = 0.5

p = setEmptyStyle(p,config)

p = p +
  theme(
    axis.ticks = element_line(colour = "black",size = 0.5),
    legend.text = element_text(size = 7),
    legend.position = c(1, 0),
    legend.justification = c(1, 0)
  )

eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
countFigNum = countFigNum+1


data_e1_center = data_e1[data_e1$data_x >= 0 & data_e1$Locs == 'Center',]
data_e1_center = aggregate( data_y ~ sub*data_x*Pattern, data = data_e1_center, FUN = "mean")
data_e1_center = aggregate( data_y ~ sub*Pattern, data = data_e1_center, FUN = "mean")

x = data_e1_center[data_e1_center$Pattern == 'Glare',]$data_y
y = data_e1_center[data_e1_center$Pattern == 'Control',]$data_y

cohen_d = cohen.d(x,y,paired=TRUE, within=TRUE)
bf = ttestBF(x = x, y = y, paired=TRUE)

center_table = list(list(
  anovaTab = t.test(x,y,var.equal=T,paired=T),
  cohend = round(abs(cohen_d[["estimate"]]),3),
  bf = round(exp(bf@bayesFactor[["bf"]]),3)
))
names(center_table) <- c('center_table')

anovaTabAll = c(anovaTabAll,center_table)

######## MPCL ########
data_MPCL = aggregate( data_y ~ sub*data_x, data = data_e1, FUN = "mean")

data_MPCL$sub = subName[data_MPCL$sub]

# data_MPCL_v = aggregate( data_y ~ sub*data_x*minLatency, data = data_e1, FUN = "mean")
# data_MPCL_v = data_MPCL_v[data_MPCL_v$data_x == data_MPCL_v$minLatency,]
# data_MPCL_v$sub = subName[data_MPCL_v$sub]
events_data$sub = subName[events_data$sub]
events_data = events_data[events_data$tag == 'min',]
p = ggplot(data_MPCL,aes(x=data_x,y=data_y,group=sub,color=sub)) +
  geom_point(data=events_data,aes(x=events,y=data_y,group=sub,color=tag),size=5) +
  # geom_point(data=data_MPCL_v,aes(x=minLatency,y=data_y,group=sub),color='red',size=5) +
  # facet_wrap(sub~.)+
  xlab('Time [Sec]') +
  ylab('Pupil changes [z-scored]') +
  # scale_color_grey(start = 0.8, end = 0.2) +
  scale_fill_manual(values=c('red','blue')) +
  geom_line(color='black')

config$ylim = round(seq(-0.5,1.5,0.25),2)
config$ylim_stride = 0.05
config$xlim = round(seq(0,4,1),2)
config$xlim_stride = 0.2

p = setEmptyStyle(p,config)

eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
countFigNum = countFigNum+1


#### gaze heatmap #### 
p = ggplot(gaze_data, aes(x=gazeX, y=gazeY,group = Locs) ) +
  stat_density_2d(aes(fill = ..density..), geom = "raster", contour = FALSE) +
  scale_fill_continuous(type = "viridis") +
  facet_wrap(Locs~.)+
  xlab("gaze x position [degree]")+
  ylab("gaze y position [degree]")

config$ylim = round(seq(-3,3,1),2)
config$ylim_stride = 0.3
config$xlim = round(seq(-3,3,1),2)
config$xlim_stride = 0.3

p = setEmptyStyle(p,config)+
  coord_fixed(ratio = 1)

eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
countFigNum = countFigNum+1

gaze_data_ave = aggregate( . ~ sub*Locs*Pattern, data = gaze_data, FUN = "mean")
gaze_data_ave$data_y = gaze_data_ave$gazeY

p <- dispLineGraph(gaze_data_ave,config,c("Locs","Pattern"))+
  facet_grid(. ~ Locs)

eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
countFigNum = countFigNum+1


```

## Figure 2
```{r, message=FALSE, warning=FALSE, echo=FALSE, fig.height=5, fig.width=13}
# p = combineGraphs(seq(1,2),'p',NULL)
# width_fig=5
# height_fig=3
# CairoPDF(file="figure/fig3A",
#          width=width_fig, height=height_fig)
print(p1)
# dev.off()
```
```{r, message=FALSE, warning=FALSE, echo=FALSE, fig.height=8, fig.width=8}
print(p2)
```
```{r, message=FALSE, warning=FALSE, echo=FALSE, fig.height=8, fig.width=8}
print(p3)
```


```{r, message=FALSE, warning=FALSE, echo=FALSE, include=FALSE}

countFigNum = 1
load("./data/dataset20211124.rda")
######## Figure 2A ########
data_auc$Locs = factor(data_auc$Locs, go1)
data_center = data_auc[data_auc$Locs == 'Center',]

config = list(
  alpha = 0.4,
  stride = 0.1,
  label_x = "",
  label_y = "Pupil Changes [z-score]",
  title = "",
  grCol = rep(c("white","black"),5),
  gr_outline =  rep(c("black","black"),5)
)

#### Figure 3A (center early) #### 
tmp = data_center[data_center$comp == 'Early',]
x = tmp[tmp$Pattern == 'Glare',]$data_y
y = tmp[tmp$Pattern == 'Control',]$data_y

cohen_d = cohen.d(x,y,paired=TRUE, within=TRUE)
bf = ttestBF(x = x, y = y, paired=TRUE)

center_early_table = list(list(
  anovaTab = t.test(x,y,var.equal=T,paired=T),
  cohend = round(abs(cohen_d[["estimate"]]),3),
  bf = round(exp(bf@bayesFactor[["bf"]]),3)
))
names(center_early_table) <- c('center_early_table')

anovaTabAll = c(anovaTabAll,center_early_table)

p <- dispLineGraph(data_center[data_center$comp == 'Early',],config,c("Locs","Pattern"))+
  facet_grid(. ~ Locs)+
  ggtitle('Early')

config$ylim = round(seq(-0.5,0,0.1),2)
config$ylim_stride = 0.05
config$xlim = round(seq(1,2,1),2)
config$xlim_stride = 0.5

p = setEmptyStyle(p,config)

p <- p + theme(
  axis.title.x=element_blank(),
  axis.text.x=element_blank(),
  axis.ticks.x = element_blank()
)

eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
countFigNum = countFigNum+1

#### Figure 3A (late early) ####
tmp = data_center[data_center$comp == 'Late',]
x = tmp[tmp$Pattern == 'Glare',]$data_y
y = tmp[tmp$Pattern == 'Control',]$data_y

cohen_d = cohen.d(x,y,paired=TRUE, within=TRUE)
bf = ttestBF(x = x, y = y, paired=TRUE)

center_late_table = list(list(
  anovaTab = t.test(x,y,var.equal=T,paired=T),
  cohend = round(abs(cohen_d[["estimate"]]),3),
  bf = round(exp(bf@bayesFactor[["bf"]]),3)
))
names(center_late_table) <- c('center_late_table')

anovaTabAll = c(anovaTabAll,center_late_table)

config$label_y = "AUC [z-score]"

p <- dispLineGraph(data_center[data_center$comp == 'Late',],config,c("Locs","Pattern"))+
  facet_grid(. ~ Locs)+
  ggtitle('Late')

config$ylim = round(seq(0.5,1.5,0.5),2)
config$ylim_stride = 0.05
config$xlim = round(seq(1,2,1),2)
config$xlim_stride = 0.5

p = setEmptyStyle(p,config)

p <- p + theme(
  axis.title.x=element_blank(),
  axis.text.x=element_blank(),
  axis.ticks.x = element_blank()
)

eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
countFigNum = countFigNum+1

#### Figure 3BC #### 
data_auc = data_auc[data_auc$Locs != 'Center',]

config$label_y = "Pupil Changes [z-score]"

p <- dispLineGraph(data_auc[data_auc$comp == 'Early',],config,c("Locs","Pattern"))+
  facet_grid(. ~ Locs)+
  ggtitle('Early')

config$ylim = round(seq(-0.2,0.2,0.1),2)
config$ylim_stride = 0.05
config$xlim = round(seq(1,2,1),2)
config$xlim_stride = 0.5

p = setEmptyStyle(p,config)
p <- p + theme(
  axis.title.x=element_blank(),
  axis.text.x=element_blank(),
  axis.ticks.x = element_blank()
)

eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
countFigNum = countFigNum+1

#### Figure 3B #### 
config$label_y = "AUC [z-score]"

p <- dispLineGraph(data_auc[data_auc$comp == 'Late',],config,c("Locs","Pattern"))+
  facet_grid(. ~ Locs)+
  ggtitle('Late(AUC)')

config$ylim = round(seq(0,1.2,0.2),2)
config$ylim_stride = 0.15
config$xlim = round(seq(1,2,1),2)
config$xlim_stride = 0.5

p = setEmptyStyle(p,config)
p <- p + theme(
  axis.title.x=element_blank(),
  axis.text.x=element_blank(),
  axis.ticks.x = element_blank()
)

eval(parse(text=paste("p", countFigNum ,"=p", sep="")))
countFigNum = countFigNum+1

#### Early component ANOVA #### 

data_anova = data_auc[data_auc$comp == 'Early',]
data_anova$comp = NULL

anovakun(data_anova,"sAB",long=T, peta=T, gg=T)

data_anova$Locs = factor(data_anova$Locs,levels = unique(data_anova$Locs))
data_anova$Pattern = factor(data_anova$Pattern,levels = unique(data_anova$Pattern))
data_anova$sub = factor(data_anova$sub,levels = unique(data_anova$sub))

data_anova_Early_BF = anovaBF(data_y ~ Locs*Pattern + sub, data=data_anova, whichRandom = "sub")

fig3a_anovatable = forDrawingSigANOVA
fig3a_ttest = forDrawingPost[["A"]][["bontab"]]
fig3a_inter = forDrawingPost[["A:B"]][["simtab"]]

data_anova_Early = list(list(
  anovaTab = forDrawingSigANOVA,
  post = forDrawingPost[["A"]][["bontab"]],
  bf = round(exp(data_anova_Early_BF@bayesFactor[["bf"]]),3),
  fig3a_ttest = fig3a_ttest,
  fig3a_inter = fig3a_inter
))

names(data_anova_Early) <- c('data_anova_Early')
anovaTabAll = c(anovaTabAll,data_anova_Early)

#### Late component ANOVA #### 
data_anova = data_auc[data_auc$comp == 'Late',]
data_anova$comp = NULL
anovakun(data_anova,"sAB",long=T, peta=T, gg=T)

data_anova$Locs = factor(data_anova$Locs,levels = unique(data_anova$Locs))
data_anova$Pattern = factor(data_anova$Pattern,levels = unique(data_anova$Pattern))
data_anova$sub = factor(data_anova$sub,levels = unique(data_anova$sub))

data_anova_Late_BF = anovaBF(data_y ~ Locs*Pattern + sub, data=data_anova, whichRandom = "sub")

fig3b_anovatable = forDrawingSigANOVA
fig3b_ttest = forDrawingPost[["A"]][["bontab"]]
fig3b_inter = forDrawingPost[["A:B"]][["simtab"]]

data_anova_Late = list(list(
  anovaTab = forDrawingSigANOVA,
  post = forDrawingPost[["A"]][["bontab"]],
  bf = round(exp(data_anova_Late_BF@bayesFactor[["bf"]]),3),
  fig3b_ttest = fig3b_ttest,
  fig3b_inter = fig3b_inter
))

names(data_anova_Late) <- c('data_anova_Late')
anovaTabAll = c(anovaTabAll,data_anova_Late)

```

## Figure 3
```{r, message=FALSE, warning=FALSE, echo=FALSE, fig.height=5, fig.width=13}
# p = combineGraphs(seq(1,2),'p',NULL)
# width_fig=5
# height_fig=3
# CairoPDF(file="figure/fig3A",
#          width=width_fig, height=height_fig)
# print(p1)
# print(p2)
# dev.off()
```
```{r, message=FALSE, warning=FALSE, echo=FALSE, fig.height=8, fig.width=13}
# print(p3)
```
```{r, message=FALSE, warning=FALSE, echo=FALSE, fig.height=8, fig.width=13}
# print(p4)
```

## Results
We presented the glare illusion and halo stimuli at one out of five VF locations (i.e., upper, lower, left, right, and center). As reported previously, enhanced pupil constriction in the Center condition was observed shown in Fig.2A 
($t$(`r anovaTabAll[["center_table"]][["anovaTab"]][["parameter"]][["df"]]`) = 
`r round(anovaTabAll[["center_table"]][["anovaTab"]][["statistic"]][["t"]],3)`, 
$p$ = `r round(anovaTabAll[["center_table"]][["anovaTab"]][["p.value"]],3)`, 
Cohen’s  $d_z$ = `r anovaTabAll[["center_table"]][["cohend"]]`, 
$BF_{10}$ =  `r anovaTabAll[["center_table"]][["bf"]]`)

To assess temporal component of papillary response, the early component corresponded to peak pupil constriction after stimulus onset and the late comportment which was defined by are under the curve (AUC) were calculated (see Method). In early component (Fig 3B), pupil constriction to the glare illusion was larger than control pattern as the previous analysis 
The two-way repeated measures ANOVA revealed a significant main effect on the pattern and VF locations ($F$(`r round(anovaTabAll[["data_anova_Early"]][["anovaTab"]][4,]['df.col'],3)`, 
`r round(anovaTabAll[["data_anova_Early"]][["anovaTab"]][5,]['df.col'],3)`) = 
`r round(anovaTabAll[["data_anova_Early"]][["anovaTab"]][4,]['f.col'],3)`, 
p = `r round(anovaTabAll[["data_anova_Early"]][["anovaTab"]][4,]['p.col'],3)`, 
$\eta^2_p$ =  `r round(anovaTabAll[["data_anova_Early"]][["anovaTab"]][4,]['p.eta^2'],3)`; 
$BF_{10}$ =  `r anovaTabAll[["data_anova_Early"]][["bf"]][2]`, 
$F$(`r round(anovaTabAll[["data_anova_Early"]][["anovaTab"]][2,]['df.col'],3)`, 
`r round(anovaTabAll[["data_anova_Early"]][["anovaTab"]][3,]['df.col'],3)`) = 
`r round(anovaTabAll[["data_anova_Early"]][["anovaTab"]][2,]['f.col'],3)`, 
p = `r round(anovaTabAll[["data_anova_Early"]][["anovaTab"]][2,]['p.col'],3)`, 
$\eta^2_p$ =  `r round(anovaTabAll[["data_anova_Early"]][["anovaTab"]][2,]['p.eta^2'],3)`, 
$BF_{10}$ =  `r anovaTabAll[["data_anova_Early"]][["bf"]][1]`). 
However, the post-hoc multiple comparisons for the VF locations showed that any pair of VF loaction did not reach the significance level (p > 0.05).
There was no significant interaction between the pattern and VF locations 
($F$(`r round(anovaTabAll[["data_anova_Early"]][["anovaTab"]][6,]['df.col'],3)`, 
`r round(anovaTabAll[["data_anova_Early"]][["anovaTab"]][7,]['df.col'],3)`) = 
`r round(anovaTabAll[["data_anova_Early"]][["anovaTab"]][6,]['f.col'],3)`, 
p = `r round(anovaTabAll[["data_anova_Early"]][["anovaTab"]][6,]['p.col'],3)`, 
$\eta^2_p$ =  `r round(anovaTabAll[["data_anova_Early"]][["anovaTab"]][6,]['p.eta^2'],3)`, 
$BF_{10}$ =  `r  round(anovaTabAll[["data_anova_Early"]][["bf"]][4]/anovaTabAll[["data_anova_Early"]][["bf"]][3],3)`).

For the Center condition, 
($t$(`r anovaTabAll[["center_early_table"]][["anovaTab"]][["parameter"]][["df"]]`) = 
`r round(anovaTabAll[["center_early_table"]][["anovaTab"]][["statistic"]][["t"]],3)`, 
$p$ = `r round(anovaTabAll[["center_early_table"]][["anovaTab"]][["p.value"]],3)`, 
Cohen’s  $d_z$ = `r anovaTabAll[["center_early_table"]][["cohend"]]`, 
$BF_{10}$ =  `r anovaTabAll[["center_early_table"]][["bf"]]`)

The two-way repeated measures ANOVA revealed a significant main effect on the VF location and interaction 
($F$(`r round(anovaTabAll[["data_anova_Late"]][["anovaTab"]][2,]['df.col'],3)`, 
`r round(anovaTabAll[["data_anova_Late"]][["anovaTab"]][3,]['df.col'],3)`) = 
`r round(anovaTabAll[["data_anova_Late"]][["anovaTab"]][2,]['f.col'],3)`, 
p = `r round(anovaTabAll[["data_anova_Late"]][["anovaTab"]][2,]['p.col'],3)`, 
$\eta^2_p$ =  `r round(anovaTabAll[["data_anova_Late"]][["anovaTab"]][2,]['p.eta^2'],3)`, 
$BF_{10}$ =  `r anovaTabAll[["data_anova_Late"]][["bf"]][1]`; 
$F$(`r round(anovaTabAll[["data_anova_Late"]][["anovaTab"]][6,]['df.col'],3)`, 
`r round(anovaTabAll[["data_anova_Late"]][["anovaTab"]][7,]['df.col'],3)`) = 
`r round(anovaTabAll[["data_anova_Late"]][["anovaTab"]][6,]['f.col'],3)`, 
p = `r round(anovaTabAll[["data_anova_Late"]][["anovaTab"]][6,]['p.col'],3)`, 
$\eta^2_p$ =  `r round(anovaTabAll[["data_anova_Late"]][["anovaTab"]][6,]['p.eta^2'],3)`, 
$BF_{10}$ =  `r  round(anovaTabAll[["data_anova_Late"]][["bf"]][4]/anovaTabAll[["data_anova_Late"]][["bf"]][3],3)`).
The UVF produces larger pupil dilation than the left and Right VFs
($t$(`r anovaTabAll[["data_anova_Late"]][["fig3b_ttest"]][1,]['df']`) = 
`r round(anovaTabAll[["data_anova_Late"]][["fig3b_ttest"]][1,]['t'],3)`, 
$p$ = `r round(anovaTabAll[["data_anova_Late"]][["fig3b_ttest"]][1,]['adj.p'],3)`; 
$t$(`r anovaTabAll[["data_anova_Late"]][["fig3b_ttest"]][2,]['df']`) = 
`r round(anovaTabAll[["data_anova_Late"]][["fig3b_ttest"]][2,]['t'],3)`, 
$p$ = `r round(anovaTabAll[["data_anova_Late"]][["fig3b_ttest"]][2,]['adj.p'],3)`; 
$t$(`r anovaTabAll[["data_anova_Late"]][["fig3b_ttest"]][3,]['df']`) = 
`r round(anovaTabAll[["data_anova_Late"]][["fig3b_ttest"]][3,]['t'],3)`, 
$p$ = `r round(anovaTabAll[["data_anova_Late"]][["fig3b_ttest"]][3,]['adj.p'],3)`; 
$t$(`r anovaTabAll[["data_anova_Late"]][["fig3b_ttest"]][4,]['df']`) = 
`r round(anovaTabAll[["data_anova_Late"]][["fig3b_ttest"]][4,]['t'],3)`, 
$p$ = `r round(anovaTabAll[["data_anova_Late"]][["fig3b_ttest"]][4,]['adj.p'],3)`; 
$t$(`r anovaTabAll[["data_anova_Late"]][["fig3b_ttest"]][5,]['df']`) = 
`r round(anovaTabAll[["data_anova_Late"]][["fig3b_ttest"]][5,]['t'],3)`, 
$p$ = `r round(anovaTabAll[["data_anova_Late"]][["fig3b_ttest"]][5,]['adj.p'],3)`; 
)

<!-- `r for(i in 1:10){print(paste('t(',anovaTabAll[["data_anova_Late"]][["fig3b_inter"]][i,]['ss.col'],')',sep=''))}` -->
`r for(i in 1:10){print(anovaTabAll[["data_anova_Late"]][["fig3b_inter"]][6,]['df.col'])}`

($t$(`r anovaTabAll[["data_anova_Late"]][["fig3b_inter"]][6,]['df.col']`) = 
`r round(anovaTabAll[["data_anova_Late"]][["fig3b_inter"]][5,]['f.col'],3)`, 
$p$ = `r round(anovaTabAll[["data_anova_Late"]][["fig3b_inter"]][5,]['p.col'],3)`, 
$\eta^2_p$ = `r round(anovaTabAll[["data_anova_Late"]][["fig3b_inter"]][5,]['p.eta^2'],3)`; 
$t$(`r anovaTabAll[["data_anova_Late"]][["fig3b_inter"]][8,]['df.col']`) = 
`r round(anovaTabAll[["data_anova_Late"]][["fig3b_inter"]][7,]['f.col'],3)`, 
$p$ = `r round(anovaTabAll[["data_anova_Late"]][["fig3b_inter"]][7,]['p.col'],3)`, 
$\eta^2_p$ = `r round(anovaTabAll[["data_anova_Late"]][["fig3b_inter"]][7,]['p.eta^2'],3)`; 
$t$(`r anovaTabAll[["data_anova_Late"]][["fig3b_inter"]][10,]['df.col']`) = 
`r round(anovaTabAll[["data_anova_Late"]][["fig3b_inter"]][9,]['f.col'],3)`, 
$p$ = `r round(anovaTabAll[["data_anova_Late"]][["fig3b_inter"]][9,]['p.col'],3)`, 
$\eta^2_p$ = `r round(anovaTabAll[["data_anova_Late"]][["fig3b_inter"]][9,]['p.eta^2'],3)`; 
$t$(`r anovaTabAll[["data_anova_Late"]][["fig3b_inter"]][12,]['df.col']`) = 
`r round(anovaTabAll[["data_anova_Late"]][["fig3b_inter"]][11,]['f.col'],3)`, 
$p$ = `r round(anovaTabAll[["data_anova_Late"]][["fig3b_inter"]][11,]['p.col'],3)`, 
$\eta^2_p$ = `r round(anovaTabAll[["data_anova_Late"]][["fig3b_inter"]][11,]['p.eta^2'],3)`
)

in line with the previous studies __(Hong et al., 2001; Sabeti et al., 2011; Tan et al., 2001; Wilhelm et al., 2000)__.

For the Center condition, 
($t$(`r anovaTabAll[["center_late_table"]][["anovaTab"]][["parameter"]][["df"]]`) = 
`r round(anovaTabAll[["center_late_table"]][["anovaTab"]][["statistic"]][["t"]],3)`, 
$p$ = `r round(anovaTabAll[["center_late_table"]][["anovaTab"]][["p.value"]],3)`, 
Cohen’s  $d_z$ = `r anovaTabAll[["center_late_table"]][["cohend"]]`, 
$BF_{10}$ =  `r anovaTabAll[["center_late_table"]][["bf"]]`)




<!-- There was no significant main effect on the pattern   -->
<!-- ($F$(`r round(anovaTabAll[["data_anova_Late"]][["anovaTab"]][2,]['df.col'],3)`,  -->
<!-- `r round(anovaTabAll[["data_anova_Late"]][["anovaTab"]][3,]['df.col'],3)`) =  -->
<!-- `r round(anovaTabAll[["data_anova_Late"]][["anovaTab"]][2,]['f.col'],3)`,  -->
<!-- p = `r round(anovaTabAll[["data_anova_Late"]][["anovaTab"]][2,]['p.col'],3)`,  -->
<!-- $\eta^2_p$ =  `r round(anovaTabAll[["data_anova_Late"]][["anovaTab"]][2,]['p.eta^2'],3)`,  -->
<!-- $BF_{10}$ =  `r anovaTabAll[["data_anova_Late"]][["bf"]][1]`). -->

<!-- There was no significant interaction between visual field and stimulus pattern  -->
<!-- ($F$(`r round(fig3a_anovatable[6,]['df.col'],3)`,  -->
<!-- `r round(fig3a_anovatable[7,]['df.col'],3)`) = `r round(fig3a_anovatable[6,]['f.col'],3)`,  -->
<!-- p = `r round(fig3a_anovatable[6,]['p.col'],3)`,  -->
<!-- $\eta^2_p$ =  `r round(fig3a_anovatable[6,]['p.eta^2'],3)`).  -->

<!-- In late component, there was a significant interaction between visual field and stimulus pattern ($F$(`r round(fig3b_anovatable[6,]['df.col'],3)`, `r round(fig3b_anovatable[7,]['df.col'],3)`) = `r round(fig3b_anovatable[6,]['f.col'],3)`, p = `r round(fig3b_anovatable[6,]['p.col'],3)`, $\eta^2_p$ =  `r round(fig3b_anovatable[6,]['p.eta^2'],3)`). Crucial, the significant differences of pupil response between glare and control stimuli was seen only in the UVF (F(1,`r round(fig3b_inter[6,]['df.col'],3)`) = `r round(fig3b_inter[5,]['f.col'],3)`,p = `r round(fig3b_inter[5,]['p.col'],3)`, $\eta^2_p$ =  `r round(fig3b_inter[5,]['p.eta^2'],3)`).  -->

<!-- $$ -->
<!-- AUC = \sum_{i=0.787}^4 x_i-x_{0.787} -->
<!-- $$ -->

## Figure 3
```{r, message=FALSE, warning=FALSE, echo=FALSE, fig.height=5, fig.width=13}

p = ggplot(ind_data_ms, aes(x = DirCat, group = Locs,fill=Pattern)) +
  geom_histogram(binwidth = 15, boundary = -15) +
  coord_polar(start = 1.57) +
  facet_grid(Pattern~Locs) +
  scale_x_continuous(breaks=seq(0, 360, by=30), expand=c(0,0), lim=c(0, 360))
  # scale_x_continuous(limits = c(0,360))

config = list(lim_x = c(sTime, eTime),
              lim_y = c(0, 0.05),
              alpha = 0.4,
              stride = 0.1,
              label_x = "Time [sec]",
              label_y = "Pupil Changes [z-scored]",
              title = "",
              linetype = FALSE
              # grCol = rep(c("#101010","#101010"),10),
              # gr_outline =  rep(c("#101010","#101010"),10)
)

p <- disp(ind_data_timeCourseMS,config,1,c("Pattern","Locs"))+
  facet_grid(Pattern ~ Locs)

# p = combineGraphs(seq(1,2),'p',NULL)
# width_fig=5
# height_fig=3
# CairoPDF(file="figure/fig3A",
#          width=width_fig, height=height_fig)
# print(p)
# dev.off()
# 
# p = combineGraphs(seq(3,4),'p',NULL)
# width_fig=13
# height_fig=5
# CairoPDF(file="figure/fig3BC",
#          width=width_fig, height=height_fig)
# print(p)
# dev.off()
# 
# width_fig=8
# height_fig=8
# CairoPDF(file="figure/gaze",
#          width=width_fig, height=height_fig)
# print(p5)
# dev.off()
```